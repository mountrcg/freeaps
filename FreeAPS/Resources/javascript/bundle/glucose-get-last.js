var freeaps_glucoseGetLast;(()=>{var e={6237:e=>{function a(e){return e.date||Date.parse(e.display_time)||Date.parse(e.dateString)}function o(e,a){a||(a=0);var o=Math.pow(10,a);return Math.round(e*o)/o}e.exports=function(e){var r=(e=e.filter((function(e){return e.glucose||e.sgv})).map((function(e){if(e.glucose=e.glucose||e.sgv,null!==e.glucose)return e}))).length;const t=e[0],u=a(t),n=a(t);var l,s=[],c=[],d=[];if(1==r)return{glucose:t.value,noise:0,delta:0,shortAvgDelta:0,longAvgDelta:0,date:n,dura_ISF_minutes:0,dura_ISF_average:t.value,slope05:0,slope15:0,slope40:0,dura_p:0,delta_pl:0,delta_pn:0,bg_acceleration:0,a_0:0,a_1:0,a_2:0,r_squ:0};for(var g=0,i=1;i<r;i++){if(void 0!==e[i]&&"cal"===e[i].type){g=i;break}if(void 0!==e[i]&&e[i].glucose>38&&e[i].device===t.device){const o=e[i],r=a(o);var h,v=0;if(void 0!==r&&void 0!==u?(h=Math.round((u-r)/6e4),l=t.glucose-o.glucose,v=l/h*5):console.error("Error: date field not found: cannot calculate avgDel"),0<h&&h<2.5)t.glucose=(t.glucose+o.glucose)/2,u=(u+r)/2;else if(2.5<h&&h<17.5)c.push(v),2.5<h&&h<7.5&&s.push(v);else{if(!(17.5<h&&h<42.5))break;d.push(v)}}}var p=0,f=0,M=0;c.length>0&&(f=c.reduce((function(e,a){return e+a}))/c.length),p=s.length>0?s.reduce((function(e,a){return e+a}))/s.length:f,d.length>0&&(M=d.reduce((function(e,a){return e+a}))/d.length);var _=t.glucose,b=_,w=0,k=a(t);for(i=1;i<r;i++){const o=e[i],r=a(o);if(_=Math.min(_,o.glucose),b=Math.max(b,o.glucose),b-_>2||k-r>66e4||n-r>36e5)break;w=(n-(k=r))/6e4}t.glucose;var m=0,F=0,S=0,x=0,D=0,I=0,q="autoISF Mod14-Debug: ";var y=t.glucose,A=t.glucose,G=0;for(i=1;i<r;i++){const o=e[i],r=a(o);if(Math.round((u-r)/6e4)-G>13)break;if(!(o.glucose>.95*A&&o.glucose<1.05*A))break;y+=o.glucose,A=y/(i+1),G=Math.round((u-r)/6e4)}m=1.05,F=1.15,S=1.4,y=0;var L,E,P=0,j=0,z=0,B=7.5;for(i=0;i<r;i++){if(L=i*j==P*P?0:(i*z-P*y)/(i*j-P*P),(E=(u-a(re=e[i]))/6e4)>B&&7.5==B&&(m=5*-L,B=17.5),E>B&&17.5==B&&(F=5*-L,B=42.5),E>B&&42.5==B){S=5*-L;break}P+=E,j+=E*E,y+=re.glucose,re.glucose*re.glucose,z+=re.glucose*E}q="";var C=0,H=0,J=0,K=(x=0,D=0,I=0,0),N=0,O=0,Q=0,R=0;if(r>3){var T=0,U=0,V=0,W=0,X=0,Y=0,Z=0,$=a(e[0]),ee=0,ae=300,oe=50;for(i=0;i<r;i++){var re,te=(a(re=e[i])-$)/1e3/ae;if(-te*ae>2820)break;if(te<ee-1.5){i<3&&(x=-ee/60,D=0,I=0,K=0,N=0,O=0,Q=0,R=0);break}ee=te;var ue=re.glucose/oe;U+=te,V+=Math.pow(te,2),W+=Math.pow(te,3),X+=Math.pow(te,4),T+=ue,Y+=te*ue,Z+=Math.pow(te,2)*ue;var ne=i+1,le=0,se=0,ce=0,de=0;if(ne>3&&(le=X*(V*ne-U*U)-W*(W*ne-U*V)+V*(W*U-V*V),se=Z*(V*ne-U*U)-Y*(W*ne-U*V)+T*(W*U-V*V),ce=X*(Y*ne-T*U)-W*(Z*ne-T*V)+V*(Z*U-Y*V),de=X*(V*T-U*Y)-W*(W*T-U*Z)+V*(W*Y-V*Z)),0!=le){var ge=se/le;L=ce/le;for(var ie=de/le,he=T/ne,ve=0,pe=0,fe=0;fe<=i;fe++){var Me=e[fe],_e=a(Me);ve+=Math.pow(Me.glucose/oe-he,2);var be=(_e-$)/1e3/ae,we=ge*Math.pow(be,2)+L*be+ie;pe+=Math.pow(Me.glucose/oe-we,2)}var ke=.64;if(0!=ve&&(ke=1-pe/ve),ne>3&&ke>=N){N=ke,x=-te*ae/60;D=-50*(ge*Math.pow(-1,2)-1*L),I=oe*(ge*Math.pow(1,2)+1*L),K=2*ge*oe,O=ie*oe,Q=L*oe,R=ge*oe,C=ge*oe,H=L*oe,J=ie*oe}}}q+="cgmFlatMinutes="+o(w,1)+"; ",q+="coeffs a/b/c=("+o(C,2)+" / "+o(H,2)+" / "+o(J,2)+"); bg date="+$+"; ",q+="Parabola Fits a0/a1/a2=("+o(O,2)+" / "+o(Q,2)+" / "+o(R,2)+"); "}return q+="Slopes 05/15/40=("+o(m,2)+" / "+o(F,2)+" / "+o(S,2)+"); ",{glucose:Math.round(1e4*t.glucose)/1e4,noise:0,delta:Math.round(1e4*p)/1e4,short_avgdelta:Math.round(1e4*f)/1e4,long_avgdelta:Math.round(1e4*M)/1e4,cgmFlatMinutes:Math.round(1e4*w)/1e4,dura_ISF_minutes:Math.round(1e4*G)/1e4,dura_ISF_average:Math.round(1e4*A)/1e4,slope05:Math.round(1e4*m)/1e4,slope15:Math.round(1e4*F)/1e4,slope40:Math.round(1e4*S)/1e4,dura_p:Math.round(1e4*x)/1e4,delta_pl:Math.round(1e4*D)/1e4,delta_pn:Math.round(1e4*I)/1e4,bg_acceleration:K,r_squ:Math.round(1e4*N)/1e4,a_0:Math.round(1e4*O)/1e4,a_1:Math.round(1e4*Q)/1e4,a_2:Math.round(1e4*R)/1e4,pp_debug:q,date:u,last_cal:g,device:t.device}}}},a={};var o=function o(r){var t=a[r];if(void 0!==t)return t.exports;var u=a[r]={exports:{}};return e[r](u,u.exports,o),u.exports}(6237);freeaps_glucoseGetLast=o})();